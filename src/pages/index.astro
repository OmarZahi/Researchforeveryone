---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Hero from '../components/Hero.astro';
import MotionWrapper from '../components/animations/MotionWrapper.astro';
import FeatureGrid from '../components/FeatureGrid.astro';
import Counter from '../components/Counter.astro';
import ContactForm from '../components/ContactForm.astro';

// Define content data for components
const howItWorksFeatures = [
  { title: 'Train', description: 'Complete a 3–4 hour safety course and pass the exam.' },
  { title: 'Badge', description: 'Receive a 12‑month Lab Readiness Passport as proof of readiness.' },
  { title: 'Book', description: 'Join supervised, pre‑approved sessions at partner labs.' }
];

const programFeatures = [
  { title: 'Passport training', description: '3–4 hour standardized safety class plus exam.' },
  { title: 'Operator sessions', description: 'Fixed ratios and pre‑approved activities at partner labs.' },
  { title: 'Portfolio builder', description: 'Attendance records and project snapshots to showcase your work.' },
  { title: 'Mentorship', description: 'Optional 1:1 or group office hours with experts.' },
  { title: 'School packs', description: 'Discount bundles for classrooms and cohorts.' },
  { title: 'Outreach days', description: 'Low‑risk demos and open lab tours for the community.' }
];

const audienceFeatures = [
  { title: 'High school students', description: 'With guardian consent; learn hands‑on safely.' },
  { title: 'Undergraduates', description: 'Supplement your coursework with real lab experience.' },
  { title: 'Recent graduates', description: 'Build your portfolio and bridge to industry or research.' }
];

const safetyFeatures = [
  { title: 'No BSL‑2+ or pathogens', description: 'Only basic biosafety level‑1 work is permitted.' },
  { title: 'No hazardous chemistry', description: 'No volatile, reactive or pressurized systems.' },
  { title: 'No unsupervised access', description: 'All sessions include named operators and fixed ratios.' }
];

const partnerFeatures = [
  { title: 'Risk controls', description: 'BSL‑1 & basic fab only; strict supervision ratios; your rules first.' },
  { title: 'Insurance & paperwork', description: 'Waivers, certificates and visitor badges simplified.' },
  { title: 'Economics', description: 'Choose revenue share on sessions or fixed facility fees with consumables at cost.' }
];

const passportFeatures = [
  { title: 'Modules', description: 'General lab safety, BSL‑1 biosafety, basic electrical/mechanical safety, code of conduct, waste disposal.' },
  { title: 'Assessment', description: 'Mix of quiz and hands‑on demonstration; badges are valid for 12 months.' },
  { title: 'Parental consent', description: 'Under‑18 participants require guardian signatures and a chaperone.' }
];

const testimonialFeatures = [
  { title: '', description: '"As a lab manager, partnering with Research for Everyone has been straightforward and rewarding. Their students arrive prepared and respectful of our space." — A. Elsayed, Fab Lab Director' },
  { title: '', description: '"The Passport program gave our students the confidence to handle equipment safely. It\'s exactly what schools have been missing." — H. Fawzy, High School Teacher' },
  { title: '', description: '"I never imagined I could work in a real lab before college. Now I\'ve completed three sessions and feel ready for internships." — M. Ahmed, Student' }
];

---
<BaseLayout title="Research for Everyone" description="Standardized safety training and operator-led lab sessions for students and early researchers.">
  <a href="#home" class="skip-link">Skip to content</a>
  <Header active="home" />

  <main>
    <!-- Hero Section with Motion One animations -->
    <Hero 
      title="Safe, supervised lab access."
      subtitle="Standardized safety training and operator‑led sessions for students and early researchers."
  primaryCta={{ text: "Get the Passport", href: "/passport" }}
  secondaryCta={{ text: "Partner your Lab", href: "/labs" }}
    />

    <!-- How it works -->
    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="how">
        <div class="container">
          <h2>How it works</h2>
          <p class="sub">We make safe lab access simple: learn safety, earn a badge, and book supervised sessions.</p>
          <FeatureGrid features={howItWorksFeatures} />
        </div>
      </section>
    </MotionWrapper>

    <!-- Metrics Section -->
    <MotionWrapper animation="fade-up" threshold={0.3}>
      <section id="metrics">
        <div class="container">
          <h2>Our impact</h2>
          <p class="sub">Small steps with measurable progress.</p>
          <div class="metrics">
            <Counter target={12} label="Partner labs" />
            <Counter target={200} label="Students trained" />
            <Counter target={45} label="Supervised sessions" />
          </div>
        </div>
      </section>
    </MotionWrapper>
    

    <!-- Programs -->
    <MotionWrapper animation="stagger" threshold={0.2}>
      <section id="programs">
        <div class="container">
          <h2>Programs</h2>
          <FeatureGrid features={programFeatures} columns={2} />
        </div>
      </section>
    </MotionWrapper>

    <!-- Visits & Workshops (concept demo) -->
    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="visits-workshops">
        <div class="container">
          <h2>Visits & Workshops</h2>
          <p class="sub">Book a guided lab visit with a subject expert, or register your interest in upcoming hands‑on workshops.</p>

          <div class="offerings">
            <div class="offering-card">
              <div class="offering-head">
                <h3>Guided Lab Visit</h3>
                <p class="lead">Example: Prof. X at Lab Y</p>
              </div>
              <ul class="meta">
                <li><strong>Duration:</strong> 90–120 minutes</li>
                <li><strong>Participants:</strong> up to 12 per slot</li>
                <li><strong>Instructor‑to‑participant ratio:</strong> 1:8 (or stricter)</li>
                <li><strong>Format:</strong> safety briefing → instrument demo → Q&A</li>
              </ul>
              <div class="btn-row">
                <a href="#register" class="btn primary">Register interest</a>
                <a href="/sessions" class="btn outline">See sample sessions</a>
              </div>
            </div>

            <div class="offering-card">
              <div class="offering-head">
                <h3>Hands‑on Workshop</h3>
                <p class="lead">Example: Intro to 3D Printing</p>
              </div>
              <ul class="meta">
                <li><strong>Duration:</strong> 2–3 hours</li>
                <li><strong>Capacity:</strong> 8–16 depending on tools</li>
                <li><strong>Instructor‑to‑participant ratio:</strong> 1:8 (fabrication), 1:4 (wet work)</li>
                <li><strong>Outcome:</strong> complete a supervised exercise and take home your work</li>
              </ul>
              <div class="btn-row">
                <a href="#register" class="btn primary">Register interest</a>
                <a href="/passport" class="btn outline">Get the Passport</a>
              </div>
            </div>
          </div>
        </div>
      </section>
    </MotionWrapper>

    <!-- Product Section -->
    <MotionWrapper animation="fade-up" threshold={0.3}>
      <section id="product">
        <div class="container">
          <div class="product">
            <img src="/img/product.png" alt="Illustration of lab equipment" loading="lazy" decoding="async" />
            <div class="product-content">
              <h3>Our product</h3>
            <p>The Lab Readiness Passport and our supervised sessions combine rigorous training with safe, hands‑on practice. Earn your badge and then step into real labs under expert supervision.</p>
            <p>We handle the logistics—insurance, waivers, scheduling and compliance—so labs can say “yes” without extra work and students can focus on learning.</p>
            <div class="btn-row">
              <a href="/passport" class="btn primary">Get the Passport</a>
              <a href="/labs" class="btn outline">Partner your Lab</a>
            </div>
          </div>
        </div>
      </div>
  </section>
    </MotionWrapper>

    <!-- Audience -->
    <MotionWrapper animation="slide-left" threshold={0.3}>
      <section id="students">
        <div class="container">
          <h2>Who it's for</h2>
          <p class="sub">We welcome everyone eager to learn.</p>
          <FeatureGrid features={audienceFeatures} />
        </div>
      </section>
    </MotionWrapper>

    <!-- Restrictions -->
  <MotionWrapper animation="fade-up" threshold={0.2}>
  <section id="safety">
      <div class="container">
        <h2>What we don’t do</h2>
        <p class="sub">To keep you and our partners safe, we limit scope:</p>
    <FeatureGrid features={safetyFeatures} />
      </div>
    </section>
  </MotionWrapper>

    <!-- Register interest (simple demo form) -->
    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="register">
        <div class="container">
          <h2>Register interest</h2>
          <p class="sub">Tell us what you’re looking for and we’ll follow up with dates and availability.</p>
          <!-- Use AJAX to avoid redirecting to Formspree's thank-you page -->
          <form id="register-form" class="register-form ajax-form" data-form-endpoint="https://formspree.io/f/mzzvqeyk" style="max-width:680px;">
            <div class="grid">
              <label>
                <span>Full name</span>
                <input name="fullName" type="text" required />
              </label>
              <label>
                <span>Email</span>
                <input name="email" type="email" required />
              </label>
              <label>
                <span>Organization / School</span>
                <input name="org" type="text" />
              </label>
              <label>
                <span>Group size</span>
                <select name="groupSize">
                  <option value="1-4">1–4</option>
                  <option value="5-8">5–8</option>
                  <option value="9-12">9–12</option>
                  <option value="13+">13+</option>
                </select>
              </label>
              <label>
                <span>Interest</span>
                <select name="interest" required>
                  <option value="visit">Guided Lab Visit</option>
                  <option value="workshop">Hands‑on Workshop</option>
                </select>
              </label>
              <label>
                <span>Preferred date</span>
                <input name="date" type="date" />
              </label>
              <label class="full">
                <span>Notes (topics, accessibility, location)</span>
                <textarea name="notes" rows="4"></textarea>
              </label>
              <!-- anti‑spam honeypot -->
              <input type="text" name="company" tabindex="-1" autocomplete="off" style="position:absolute;left:-5000px;opacity:0;" aria-hidden="true" />
            </div>
            <button type="submit" class="btn primary" style="margin-top:16px;">Submit</button>
            <p class="fineprint">Typical ratios: 1:8 for fabrication tools, 1:4 for wet benches. Activities remain within low‑risk scope and host SOPs.</p>
            <div class="form-status" aria-live="polite"></div>
          </form>
          <script is:inline>
          // Inline handler to prevent off-site redirect and show inline status
          (function(init){
            if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init, { once: true });
            else init();
          })(() => {
            const form = document.getElementById('register-form');
            if (!form) return;
            const status = form.querySelector('.form-status');
            const endpoint = form.getAttribute('data-form-endpoint') || '';
            const honeypot = form.querySelector('input[name="company"]');
            
            form.addEventListener('submit', (e) => {
              e.preventDefault();
              if (honeypot && honeypot.value) { if (status) status.textContent = 'Thanks!'; form.reset(); return; }
              if (!endpoint) { if (status) status.textContent = 'Thanks! Your message was captured locally.'; form.reset(); return; }
              const formData = new FormData(form);
              if (status) { status.style.color = 'var(--ink-500)'; status.textContent = 'Sending…'; }
              fetch(endpoint, { method: 'POST', body: formData, headers: { 'Accept': 'application/json' } })
              .then((res) => {
                if (res.ok) {
                  if (status) { status.style.color = 'var(--p-600)'; status.textContent = 'Thank you! We\'ll be in touch.'; }
                  form.reset();
                } else {
                  return res.json().catch(() => ({})).then((data) => { throw new Error(data.error || 'Submission failed.'); });
                }
              })
              .catch((err) => {
                if (status) { status.style.color = '#b00020'; status.textContent = 'Oops, something went wrong. Please email Omar.2123039@stemobour.moe.edu.eg'; }
                console.error(err);
              });
            });
          });
          </script>
        </div>
      </section>
    </MotionWrapper>

    <!-- Labs & Partners -->
  <MotionWrapper animation="fade-up" threshold={0.2}>
  <section id="labs">
      <div class="container">
        <h2>Partner with us</h2>
        <p class="sub">Off‑peak revenue on idle capacity, pre‑trained visitors, and admin handled.</p>
    <FeatureGrid features={partnerFeatures} />
        <div class="cta-row" style="margin-top:32px;">
          <a href="/contact" class="btn primary">Apply to partner</a>
        </div>
      </div>
    </section>
  </MotionWrapper>

    <!-- Passport Section -->
  <MotionWrapper animation="fade-up" threshold={0.2}>
  <section id="passport">
      <div class="container">
        <h2>Lab Readiness Passport</h2>
        <p class="sub">A concise safety curriculum plus exam to earn your readiness badge.</p>
    <FeatureGrid features={passportFeatures} />
        <div class="cta-row" style="margin-top:32px;">
          <a href="/contact" class="btn primary">Enroll now</a>
        </div>
      </div>
    </section>
  </MotionWrapper>

    <!-- Testimonials Section -->
  <MotionWrapper animation="fade-up" threshold={0.2}>
  <section id="testimonials">
      <div class="container">
        <h2>Voices from the community</h2>
    <FeatureGrid features={testimonialFeatures} />
      </div>
    </section>
  </MotionWrapper>

    <!-- Partners Section -->
    <MotionWrapper animation="fade-up" threshold={0.2}>
    <section id="partners" class="partners-section">
      <div class="container">
        <h2>Our partners</h2>
        <p class="sub">Organisations that support hands‑on research access.</p>
        <div class="partner-slider">
          <div class="slide-track">
      <img src="/img/partners/partner1.png" alt="Partner 1" loading="lazy" decoding="async" />
      <img src="/img/partners/partner2.png" alt="Partner 2" loading="lazy" decoding="async" />
      <img src="/img/partners/partner3.png" alt="Partner 3" loading="lazy" decoding="async" />
            <!-- duplicate for seamless looping -->
      <img src="/img/partners/partner1.png" alt="Partner 1" loading="lazy" decoding="async" />
      <img src="/img/partners/partner2.png" alt="Partner 2" loading="lazy" decoding="async" />
      <img src="/img/partners/partner3.png" alt="Partner 3" loading="lazy" decoding="async" />
          </div>
        </div>
      </div>
    </section>
    </MotionWrapper>

    <!-- FAQ Section removed from home page to avoid repetition; visit faq.html for full answers -->

    <!-- Contact Section -->
    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="contact">
        <div class="container">
          <h2>Get in touch</h2>
          <p class="sub">Interested in partnering, mentoring or joining a pilot? We’d love to hear from you.</p>
          <p>Email us at <a href="mailto:Omar.2123039@stemobour.moe.edu.eg">Omar.2123039@stemobour.moe.edu.eg</a> or fill out our simple interest form below.</p>
          <ContactForm compact={true} />
        </div>
      </section>
    </MotionWrapper>
  </main>
  <Footer />
</BaseLayout>

<style>
/* Sections + utilities local to this page */
section { padding: 64px 0; scroll-margin-top: 84px; }
section h2 { margin: 0 0 16px 0; font-size: 2rem; color: var(--ink-900); }
section p.sub { font-size: 1.125rem; color: var(--ink-500); margin-bottom: 32px; max-width: 640px; }

.metrics { display: flex; flex-wrap: wrap; justify-content: space-around; gap: 32px; margin-top: 32px; }
.metric { text-align: center; flex: 1 1 200px; }
.metric .count { font-size: 3rem; font-weight: 700; color: var(--p-600); }
.metric p { margin-top: 8px; font-size: 1rem; color: var(--ink-500); }

.product { display: flex; align-items: center; gap: 48px; flex-wrap: wrap; }
.product img { max-width: 480px; width: 100%; border-radius: var(--radius); box-shadow: var(--shadow); }
.product .product-content { flex: 1 1 300px; }
.product .product-content h3 { margin-top: 0; font-size: 2rem; color: var(--ink-900); }
.product .product-content p { margin-top: 12px; font-size: 1.1rem; color: var(--ink-500); }
.product .product-content .btn-row { margin-top: 24px; display: flex; gap: 16px; }

.partners-section { padding: 64px 0; }
.partner-slider { overflow: hidden; width: 100%; border: 1px solid var(--line-200); border-radius: var(--radius); background: var(--bg-0); margin-top: 32px; }
.partner-slider .slide-track { display: flex; width: calc(200% + 40px); animation: scroll 25s linear infinite; }
.partner-slider .slide-track img { height: 60px; width: auto; margin: 0 40px; object-fit: contain; filter: grayscale(100%); opacity: 0.7; transition: opacity 0.3s ease; }
.partner-slider .slide-track img:hover { opacity: 1; filter: none; }
.partner-slider:hover .slide-track { animation-play-state: paused; }
@keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-50%); } }
@media (max-width: 768px) { .product { gap: 24px; } }
@media (max-width: 480px) {
  section { padding: 48px 0; }
  .metrics { gap: 16px; }
  .partner-slider .slide-track img { height: 44px; margin: 0 24px; }
}

/* Offerings cards */
.offerings { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 24px; }
.offering-card { background: var(--bg-0); border: 1px solid var(--line-200); border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow); }
.offering-head h3 { margin: 0; font-size: 1.5rem; color: var(--ink-900); }
.offering-head .lead { margin: 4px 0 12px 0; color: var(--p-600); font-weight: 600; }
.offering-card .meta { list-style: none; padding: 0; margin: 0 0 16px 0; color: var(--ink-600); }
.offering-card .meta li { margin: 6px 0; }
.register-form .grid { display: grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 12px; }
.register-form label { display: flex; flex-direction: column; gap: 6px; color: var(--ink-700); }
.register-form label.full { grid-column: 1 / -1; }
.register-form input, .register-form select, .register-form textarea { padding: 12px; border-radius: var(--radius); border: 1px solid var(--line-200); background: var(--bg-0); }
.fineprint { margin-top: 8px; color: var(--ink-500); font-size: 0.95rem; }
.register-form .form-status { margin-top: 10px; font-size: 0.95rem; color: var(--ink-500); }

@media (max-width: 900px) { .offerings { grid-template-columns: 1fr; } }
@media (max-width: 640px) { .register-form .grid { grid-template-columns: 1fr; } }
@media (prefers-reduced-motion: reduce) { .partner-slider .slide-track { animation: none !important; } }
</style>
