---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Hero from '../components/Hero.astro';
import MotionWrapper from '../components/animations/MotionWrapper.astro';
import FeatureGrid from '../components/FeatureGrid.astro';
import Counter from '../components/Counter.astro';
import { programTracks } from '../data/program';

const aboutCards = [
  { title: 'Onboarding squads', description: 'We place learners in small pods with a coach who stays with them through every visit.' },
  { title: 'Clear playbooks', description: 'Each session comes with printable briefs, playlists, and the exact tools we will touch.' },
  { title: 'Showcase ready', description: 'Students wrap with photo-ready logs and reflections they can share with families and schools.' }
];

const aboutList = [
  'Small, supervised sessions across Cairo and Alexandria',
  'Flexible weekend and after-school slots',
  'Mentors who speak the same language as our students'
];

const disciplinePrograms = programTracks.map((track) => ({
  id: track.id,
  title: track.title,
  tag: track.tag,
  description: track.blurb || track.description,
}));

const experienceHighlights = [
  { title: 'Guided entries', description: 'Operators meet every group at the door, set expectations, and keep the pace welcoming.' },
  { title: 'Studio playlists', description: 'We pair each visit with music, lighting, and visuals so the space feels alive.' },
  { title: 'Story-driven notes', description: 'Each cohort leaves with a simple recap so families and teachers can follow along.' }
];

const labBenefits = [
  { title: 'Simple coordination', description: 'We match your calendar, handle RSVPs, and keep things on time.' },
  { title: 'Ready-made materials', description: 'Prep lists, waivers, and signage arrive before the session so nothing feels rushed.' },
  { title: 'Shared momentum', description: 'We capture photos, quotes, and light data so your lab’s impact is seen.' }
];

const storyQuotes = [
  { quote: '“Our biology club finally works with real microscopes every month. The mentors feel like older siblings.”', source: 'Mina, Student Lead' },
  { quote: '“Coordination was effortless. The team arrived early, briefed everyone, and left the lab spotless.”', source: 'Dr. Salma, Lab Director' },
  { quote: '“I saw my son come home excited about chemistry for the first time. He even shared the recap deck with his class.”', source: 'Mrs. Adel, Parent' }
];

---
<BaseLayout title="Research for Everyone" description="Standardized safety training and operator-led lab sessions for students and early researchers.">
  <a href="#home" class="skip-link">Skip to content</a>
  <Header active="home" />

  <main>
    <!-- Hero Section with Motion One animations -->
        <Hero 
          title="Democratizing Lab Access."
          subtitle="We host classrooms, clubs, and solo learners inside Egyptian labs with calm studio energy."
        primaryCta={{ text: "Apply now", href: "/programs/admissions" }}
        secondaryCta={{ text: "Learn more", href: "#about" }}
      />

      <MotionWrapper animation="fade-up" threshold={0.2}>
        <section id="about" class="section-shell" data-reveal>
          <div class="container about-grid">
            <div class="about-copy">
              <p class="eyebrow">About us</p>
              <h2>Lab access that feels welcoming.</h2>
              <p>We build calm, beautiful lab moments where young researchers feel trusted. Every visit comes with a host, a plan, and enough breathing room to try things twice.</p>
              <ul class="about-list">
                {aboutList.map((item) => (
                  <li>{item}</li>
                ))}
              </ul>
            </div>
            <div class="about-cards">
              {aboutCards.map((item) => (
                <article class="about-card">
                  <h3>{item.title}</h3>
                  <p>{item.description}</p>
                </article>
              ))}
            </div>
          </div>
        </section>
      </MotionWrapper>

    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="programs" class="section-shell" data-reveal>
        <div class="container">
          <h2>Programs by discipline</h2>
          <p class="sub">Biology, chemistry, electronics, fabrication, climate, and more—each with its own vibe.</p>
          <div class="block-grid block-grid--programs">
            {disciplinePrograms.map((item, index) => (
              <a href={`/programs/details#${item.id}`} class="block-card" style={`--card-hue: ${(index * 38 + 210) % 360};`}>
                <span class="block-pill">{item.tag}</span>
                <div class="card-body">
                  <h3>{item.title}</h3>
                  <p>{item.description}</p>
                </div>
                <span class="block-link">See modules →</span>
              </a>
            ))}
          </div>
        </div>
      </section>
    </MotionWrapper>

    <MotionWrapper animation="fade-up" threshold={0.3}>
      <section id="metrics" class="section-shell soft" data-reveal>
        <div class="container">
          <h2>Moments that add up</h2>
          <p class="sub">Every number tracks a real experience shared between students and labs.</p>
          <div class="metrics">
            <Counter target={12} label="Partner labs" />
            <Counter target={200} label="Learners hosted" />
            <Counter target={45} label="Studio sessions" />
          </div>
        </div>
      </section>
    </MotionWrapper>

    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="experience" class="section-shell" data-reveal>
        <div class="container">
          <h2>The experience</h2>
          <p class="sub">Scrolling through the page should feel like strolling through our studios—calm, animated, and intentional.</p>
          <FeatureGrid features={experienceHighlights} columns={3} />
        </div>
      </section>
    </MotionWrapper>

    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="labs" class="section-shell" data-reveal>
        <div class="container">
          <h2>For labs & partners</h2>
          <p class="sub">Keep your space lively without extra lift. We arrive prepared, leave the benches shining, and send a recap before the day ends.</p>
          <FeatureGrid features={labBenefits} columns={3} />
          <div class="cta-row">
            <a href="/programs/overview" class="btn primary">See the full playbook</a>
            <a href="mailto:hello@researchforeveryone.org" class="btn outline">Email the team</a>
          </div>
        </div>
      </section>
    </MotionWrapper>

    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="stories" class="section-shell soft" data-reveal>
        <div class="container">
          <h2>Stories we’re proud of</h2>
          <p class="sub">Scrolling testimonials pulse gently as you move—because emotions should feel animated too.</p>
          <div class="story-grid">
            {storyQuotes.map((story) => (
              <article class="story-card">
                <p>{story.quote}</p>
                <span>{story.source}</span>
              </article>
            ))}
          </div>
        </div>
      </section>
    </MotionWrapper>

    <MotionWrapper animation="fade-up" threshold={0.2}>
      <section id="partners" class="partners-section section-shell" data-reveal>
        <div class="container">
          <h2>Partners & friends</h2>
          <p class="sub">Studios, fab labs, and community centers that welcome our students.</p>
          <div class="partner-slider">
            <div class="slide-track">
              <img src="/img/partners/partner1.png" alt="Partner 1" loading="lazy" decoding="async" />
              <img src="/img/partners/partner2.png" alt="Partner 2" loading="lazy" decoding="async" />
              <img src="/img/partners/partner3.png" alt="Partner 3" loading="lazy" decoding="async" />
              <img src="/img/partners/partner1.png" alt="Partner 1" loading="lazy" decoding="async" />
              <img src="/img/partners/partner2.png" alt="Partner 2" loading="lazy" decoding="async" />
              <img src="/img/partners/partner3.png" alt="Partner 3" loading="lazy" decoding="async" />
            </div>
          </div>
        </div>
      </section>
    </MotionWrapper>
  </main>
  <Footer />
</BaseLayout>

<script is:inline>
document.addEventListener('DOMContentLoaded', () => {
  if (!('IntersectionObserver' in window)) {
    document.querySelectorAll('[data-reveal]').forEach((el) => el.classList.add('is-visible'));
    return;
  }
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.2, rootMargin: '0px 0px -10% 0px' });

  document.querySelectorAll('[data-reveal]').forEach((el) => observer.observe(el));
});
</script>

<style>
section { padding: 72px 0; scroll-margin-top: 90px; }
section h2 { margin: 0 0 16px; font-size: clamp(1.8rem, 3vw, 2.4rem); color: var(--ink-900); }
section p.sub { font-size: 1.125rem; color: var(--ink-500); margin-bottom: 32px; max-width: 640px; }

.section-shell {
  position: relative;
  isolation: isolate;
  overflow: hidden;
}

.section-shell::after {
  content: '';
  position: absolute;
  inset: 10%;
  background: radial-gradient(circle at 20% 20%, rgba(73, 132, 255, 0.15), transparent 60%),
              radial-gradient(circle at 80% 40%, rgba(76, 201, 240, 0.12), transparent 55%);
  filter: blur(10px);
  opacity: 0.7;
  z-index: -1;
  animation: float-glow 16s ease-in-out infinite alternate;
}

.section-shell.soft::after {
  inset: 5%;
  background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.6), transparent 65%),
              radial-gradient(circle at 70% 60%, rgba(209, 233, 255, 0.5), transparent 60%);
}

[data-reveal] {
  opacity: 0;
  transform: translateY(36px);
  transition: opacity 0.8s ease, transform 0.8s ease;
}

[data-reveal].is-visible {
  opacity: 1;
  transform: translateY(0);
}

.about-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 32px; align-items: start; }
.about-copy .eyebrow { text-transform: uppercase; font-size: 0.85rem; letter-spacing: 0.08em; color: var(--p-600); margin: 0 0 8px; }
.about-list { list-style: none; padding: 0; margin: 24px 0 0; display: grid; gap: 12px; }
.about-list li { display: flex; gap: 10px; align-items: center; color: var(--ink-600); font-size: 1rem; }
.about-list li::before { content: ''; width: 10px; height: 10px; border-radius: 50%; background: var(--p-500); box-shadow: 0 0 12px rgba(46,142,255,0.6); }
.about-cards { display: grid; gap: 16px; }
.about-card { border: 1px solid rgba(62, 94, 180, 0.15); border-radius: 18px; padding: 24px; background: rgba(255, 255, 255, 0.92); box-shadow: 0 18px 50px rgba(15, 23, 42, 0.08); backdrop-filter: blur(8px); }
.about-card h3 { margin: 0 0 8px; font-size: 1.2rem; color: var(--ink-900); }
.about-card p { margin: 0; color: var(--ink-500); }

.metrics { display: flex; flex-wrap: wrap; justify-content: center; gap: 32px; margin-top: 32px; }
.metric { text-align: center; flex: 1 1 200px; padding: 24px; border-radius: 18px; background: rgba(255,255,255,0.8); box-shadow: 0 20px 40px rgba(15,23,42,0.08); }
.metric .count { font-size: 3rem; font-weight: 700; color: var(--p-600); }
.metric p { margin-top: 8px; font-size: 1rem; color: var(--ink-500); }

.block-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 24px;
}

.block-card {
  --card-hue: 210;
  position: relative;
  border-radius: 28px;
  padding: 28px;
  min-height: 180px;
  background: radial-gradient(circle at 15% 20%, hsla(var(--card-hue), 90%, 85%, 0.45), transparent 60%),
              linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(225, 236, 255, 0.8));
  border: 1px solid rgba(86, 114, 255, 0.18);
  box-shadow: 0 35px 70px rgba(15, 23, 42, 0.16);
  overflow: hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  text-decoration: none;
  color: inherit;
  display: block;
}

.block-card::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 80% 0%, hsla(var(--card-hue), 90%, 75%, 0.4), transparent 45%);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.block-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 40px 80px rgba(5, 13, 32, 0.25);
}

.block-card:hover::after { opacity: 1; }

.block-card .card-body { position: relative; z-index: 1; }
.block-card h3 { margin: 0 0 8px; font-size: 1.35rem; color: var(--ink-900); }
.block-card p { margin: 0; color: var(--ink-600); }
.block-link {
  position: relative;
  z-index: 1;
  margin-top: 18px;
  display: inline-flex;
  align-items: center;
  font-weight: 600;
  color: #1f3fff;
}

.block-pill {
  position: relative;
  z-index: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 0.85rem;
  font-weight: 700;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  padding: 6px 14px;
  border-radius: 999px;
  background: rgba(15, 23, 42, 0.1);
  color: var(--ink-800);
  margin-bottom: 18px;
  border: 1px solid rgba(15, 23, 42, 0.1);
  backdrop-filter: blur(8px);
}

.block-grid--programs { margin-top: 32px; }

.cta-row { margin-top: 32px; display: flex; flex-wrap: wrap; gap: 16px; }

.story-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
.story-card { padding: 28px; border-radius: 24px; background: rgba(13, 20, 35, 0.9); color: #fff; box-shadow: 0 20px 45px rgba(9, 9, 24, 0.4); position: relative; overflow: hidden; }
.story-card::after { content: ''; position: absolute; inset: 0; background: radial-gradient(circle at 20% 20%, rgba(80, 156, 255, 0.25), transparent 50%); mix-blend-mode: screen; }
.story-card p { margin: 0 0 16px; font-size: 1.05rem; line-height: 1.5; }
.story-card span { font-size: 0.95rem; color: rgba(255,255,255,0.8); }

.partner-slider { overflow: hidden; width: 100%; border: 1px solid rgba(255,255,255,0.2); border-radius: 24px; background: rgba(255,255,255,0.9); margin-top: 32px; }
.partner-slider .slide-track { display: flex; width: calc(200% + 40px); animation: scroll 25s linear infinite; }
.partner-slider .slide-track img { height: 60px; width: auto; margin: 0 40px; object-fit: contain; filter: grayscale(100%); opacity: 0.8; transition: opacity 0.3s ease; }
.partner-slider .slide-track img:hover { opacity: 1; filter: none; }
.partner-slider:hover .slide-track { animation-play-state: paused; }

@keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-50%); } }
@keyframes float-glow { from { transform: translateY(0); } to { transform: translateY(-20px); } }

@media (max-width: 900px) {
  .about-grid { grid-template-columns: 1fr; }
}

@media (max-width: 600px) {
  section { padding: 56px 0; }
  .metrics { gap: 16px; }
  .partner-slider .slide-track img { height: 44px; margin: 0 24px; }
}

@media (prefers-reduced-motion: reduce) {
  [data-reveal] { opacity: 1 !important; transform: none !important; }
  .section-shell::after { animation: none; }
  .partner-slider .slide-track { animation: none; }
}
</style>
